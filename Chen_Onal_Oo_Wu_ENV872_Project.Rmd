\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

---
title: "Factors influencing Turkiye's Growth"
author: "Fei Wu, Merve Onal, Siyao Chen, Ye Khaung Oo"
date: "2024-04-23"
output: pdf_document
geometry: margin=2.54cm
editor_options: 
  chunk_output_type: console
---
```{r setup, include=FALSE, tidy=TRUE, error=FALSE}

#Ye Working on this

#Loading packages
library(tidyverse); library(lubridate);library(zoo);
library(trend); library(ggplot2); library(ggthemes);
library(readxl); library(here); library(dplyr); library(Rmisc)

#Checking working directory
#setwd("./Data/Processed")
getwd()

#importing dataset
data <- read_excel("./Data/Processed/Data_for_R_Project.xlsx")
str(data)

#making sure the years are converted into date format
data <- data.frame(data)
data$Years <- as.Date(data$Years)

#setting theme for each contributor
ye_theme <- theme_economist_white(base_size = 14) +
  theme(axis.text = element_text(color = "red"), 
        legend.position = "top") #alternative: legend.position + legend.justification

merve_theme <- theme_excel_new(base_size = 14) +
  theme(axis.text = element_text(color = "blue"), 
        legend.position = "top") 

fei_theme <- theme_fivethirtyeight(base_size = 14) +
  theme(axis.text = element_text(color = "black"), 
        legend.position = "top") 

siyao_theme <- theme_wsj(base_size = 14) +
  theme(axis.text = element_text(color = "brown"), 
        legend.position = "top") 

```


# Rationale and Research Questions

How does GDP growth relate to investment growth, capital accumulation and population growth in Turkiye from 1999-2022 period? Does electricity consumption have any relationship with GDP, investment and population? 

## Background

We analyze the effect of investment growth which corresponds to capital accumulation and population growth on the GDP growth of Turkiye for the 1999-2022 period. We also analyze the impact of electricity consumption on the GDP growth.
We have found a dataset from Turkiye (references) and the data points are stored as log grwoth point.

## Significance

Understanding the relationship between electricity consumption and GDP growth is crucial. Understanding the behavior of electricity consumption in relation to the economy is very important for improve to a stable economic growth and development (Kasperowicz, 2014: 46).


## Theoretical Context

The hypothesis underlying this research is that an increase in electricity consumption leads to GDP growth. This hypothesis is grounded in the understanding that investment, population and electricity consumption which explains GDP growth.

## Visualize
```{r trendline, tidy=TRUE, error=FALSE}

#Merve Working on This. YKO doesn't know how to interpret these graphs. Need to ask Merve

#setwd("~/Chen_Onal_Oo_Wu/Data/Processed")
#data <- read_excel("Data_for_R_Project.xlsx")
#str(data)
#data$Years <- as.Date(data$Years)
#install.packages("Rmisc")
#library(Rmisc)

# Function to create time series plot with custom title and axis labels
create_ts_plot <- function(data, variable_name, main_title, xlab_title, ylab_title) {
  plot(data, main = main_title, xlab = xlab_title, ylab = ylab_title)
}
  # Remove rows with missing values in any of the columns
  #data <- na.omit(data)
  
#library(ggplot2)
# Assuming you have a data frame named 'my_data' containing columns 'Invgro', 'GDPgro', and 'Popgro'

# Create the plot using ggplot2
ggplot(data, aes(x = GDPgro, y = Invgro)) + 
geom_point() +
labs(title = "GDP and Investment")+
  geom_line(color = "blue") 
# Create the plot using ggplot2
ggplot(data, aes(x = GDPgro, y = Popgro)) +
  geom_point() +
labs(title = "GDP and Population")+
  geom_line(color = "red") 
 
# Create the plot using ggplot2
ggplot(data, aes(x = GDPgro, y = Electricitygro)) +
  geom_point() +
labs(title = "GDP and Electricity")+
  geom_line(color = "green") 
# Create the plot using ggplot2
ggplot(data, aes(x = Invgro, y = Electricitygro)) +
  geom_point() +
labs(title = "Investment and Electricity")+
  geom_line(color = "black") 
# Create the plot using ggplot2
ggplot(data, aes(x = Popgro, y = Electricitygro)) +
    geom_point() +
labs(title = "Population and Electricity")+
  geom_line(color = "yellow") 
# Create the plot using ggplot2
ggplot(data, aes(x = Invgro, y = Electricitygro)) +
    geom_point() +
labs(title = "Investment and Electricity")+
  geom_line(color = "purple") 
# Create the plot using ggplot2 in one graph
ggplot(data, aes(x = Years)) + 
  geom_line(aes(y = Invgro, colour = "Investment")) + 
  geom_line(aes(y = Popgro, colour = "Population")) +
  geom_line(aes(y = Electricitygro, colour = "Electricity")) +
  labs(title = "Investment, Population and Electricity")+
  scale_x_continuous(breaks = seq(1999, 2022, by = 2)) +
  ylab("Values") +
  xlab("Year")

```

>Explanation: In the first plot, GDP growth is represented on the x-axis, and Investment growth is represented on the y-axis. There appears to be a positive relationship between the two variables; higher investments correspond to higher GDP growth.
In the second plot, GDP growth is represented on the x-axis, and Population growth is represented on the y-axis. There appears not to be a positive relationship between the two variables; even negative population changes correspond to higher GDP growth.
In the third plot, GDP growth is represented on the x-axis, and Electricity consumption growth is represented on the y-axis. There appears to be a positive relationship between the two variables.
In the fourth plot, Investment growth is represented on the x-axis, and Electricity consumption is represented on the y-axis. There appears to be a positive relationship between the two variables; higher investments correspond to higher electricity consumpton.
In the fifth plot, population growth is represented on the x-axis, and Electricity consumption is represented on the y-axis. There appears not to be a positive relationship between the two variables.
In the sixth plot, Investment growth is represented on the x-axis, and Population growth is represented on the y-axis. There appears not to be a significant relationship between the two variables.
In the seventh plot, Investment growth, Population growth, and Electricity consumption growth are represented from 1999 to 2022. Population changes are smooth and stable, while electricity consumption changes occur within a short range. Investment growth fluctuates widely and is far from being stable from year to year.
 

# Dataset Information



\newpage

# Exploratory Analysis 
```{r time.series, tidy=TRUE, error=FALSE}

#Merve Working on t his
#setwd("~/Chen_Onal_Oo_Wu/Data/Processed")
#data <- read_excel("Data_for_R_Project.xlsx")
#str(data)
#data$Years <- as.Date(data$Years)



```
\newpage
 

## Time Series Analysis
```{r}
#Merve Working On This

# creating time series for GDP data
ts_GDPdata <- ts(data$GDPgro, start = min(1999), end = max(2022), frequency = 24)

# creating time series for Investment data
ts_Invdata <- ts(data$Invgro, start = min(1999), end = max(2022), frequency = 24)

# creating time series for Populaton data
ts_Popdata <- ts(data$Popgro, start = min(1999), end = max(2022), frequency = 24)

# creating time series for Electricity data
ts_Elecdata <- ts(data$Electricitygro, start = min(1999), end = max(2022), frequency = 24)

# Decomposing the time series
ts_GDPdata.decomp <- stl(ts_GDPdata, s.window = "periodic")
plot(ts_GDPdata.decomp)
ts_Invdata.decomp <- stl(ts_Invdata, s.window = "periodic")
plot(ts_Invdata.decomp)
ts_Popdata.decomp <- stl(ts_Popdata, s.window = "periodic")
plot(ts_Popdata.decomp)
ts_Elecdata.decomp <- stl(ts_Elecdata, s.window = "periodic")
plot(ts_Elecdata.decomp)

#The following graphs should be the first graph for exploring the trend. But I'm not sure if this is time series.

plot(ts_data, main = "GDP Growth Over Time", xlab = "Years", ylab = "GDP Growth")
plot(ts_data, main = "Investment Growth Over Time", xlab = "Years", ylab = "Investment growth")
plot(ts_data, main = "Population Growth Over Time", xlab = "Years", ylab = "Population growth")
plot(ts_data, main = "Electricity Consumption Growth Over Time", xlab = "Years", ylab = "electricity consumption growth")

```
>Explanation: In the first plot, decomposed GDP growth data is presented. The data does not exhibit seasonality due to its yearly nature, and there is also no discernible upward or downward trend. However, following the Covid-19 pandemic, the shock creates outlier effects on the data.
In the second plot, decomposed Investment growth data is presented. The data does not exhibit seasonality due to its yearly nature, and there is also no discernible upward or downward trend. However, following the Covid-19 pandemic, the shock creates outlier effects on the data.
In the third plot, decomposed Population growth data is presented. The data does not exhibit seasonality due to its yearly nature, and there is also no discernible upward or downward trend. However, following the Covid-19 pandemic, the shock creates outlier effects on the data.
In the fourth plot, decomposed Electricity consumption growth data is presented. The data does not exhibit seasonality due to its yearly nature, and there is also no discernible upward or downward trend. However, following the Covid-19 pandemic, the shock creates outlier effects on the data.
In the fifth plot, GDP growth time series data is presented. The data does exhibit fluctuations, but apart from a few years, it shows an increase.
In the sixth plot, Investment growth time series data is presented. The data does exhibit fluctuations, but apart from a few years, it shows an increase.
In the seventh plot, Population growth time series data is presented. The data does exhibit fluctuations, but apart from a few years, it shows an increase.
In the seventh plot, Electricity consumption growth time series data is presented. The data does exhibit fluctuations, but apart from a few years, it shows an increase.


# Analysis
### NOT SURE ABOUT THIS PART TEAM
```{r}
install.packages("corrplot")
library(corrplot)
library(forecast)
install.packages("package_name")

ts_GDPdata.decomp <- decompose(ts_GDPdata)
plot(ts_GDPdata.decomp)
# Extract trend component
trend_GDP <- ts_GDPdata.decomp$trend
plot(trend_GDP)
# Extract seasonal component
seasonal_GDP <- ts_GDPdata.decomp$seasonal
plot(seasonal_GDP)
# ACF plot
acf(ts_GDPdata)

# Compute correlation matrix
correlation_matrix <- cor(data[, c("GDPgro", "Invgro", "Popgro", "Electricitygro")])

# Visualize correlation matrix
corrplot(correlation_matrix, method = "circle")

# Plot time series
plot(ts_GDPdata, main = "GDP Growth Over Time", xlab = "Year", ylab = "GDP Growth")
lines(ts_Invdata, col = "blue")
lines(ts_Popdata, col = "red")
lines(ts_Elecdata, col = "green")
legend("topright", legend = c("GDP Growth", "Investment Growth", "Population Growth", "Electricity Growth"), col = c("black", "blue", "red", "green"), lty = 1)




```

## Question 1: <insert specific question here and add additional subsections for additional questions below, if needed>
Has electricity consumption increased with GDP growth during the period from 1999 to 2022 in Turkiye?

## Question 2: 
Have electricity consumption increased with investment and population growth during the period from 1999 to 2022 in Turkiye?


\newpage

# Summary and Conclusions
When examining the decomposed data, it is evident that yearly data do not exhibit seasonality. The graphs depicting GDP growth, investment growth, population growth, and electricity consumption growth do not display any upward or downward trends; instead, the data shows a horizontal and stationary pattern
Positive relationships:
 There is a positive relationship between investment growth and GDP growth. 
 There is a positive relationship between GDP growth and electricity consumption growth. 
 There is a positive relationship between investment growth and electricity consumption growth.
 There is a negative relationship between population and GDP growth. 
No clear relationships:
 There is no clear relationship between population and electricity consumption growth. 
 There is no clear relationship between population and investment growth. 


\newpage

# References
<add references here if relevant, otherwise delete this section> 

###Siyao's Analysis

## Question1:
How are GDP growth, population growth, investment growth, and electricity consumption interrelated in Turkiye from 1999 to 2022?

#Background:
This analysis aims to explore the interdependencies between critical economic indicators that influence Turkiye's economic landscape over a significant period. By examining the correlations among these variables, we seek to understand how each one potentially impacts or correlates with the others, particularly in terms of GDP growth.

#Significance:
Understanding the relationships between these economic indicators is essential for developing informed economic policies and investment strategies. By identifying the strength and direction of these relationships, policymakers and economists can better predict future trends and make decisions that aim to foster economic stability and growth.

#Theoratical Context:
The hypothesis for this analysis posits that significant correlations exist between GDP growth and other key economic indicators like population growth, investment growth, and electricity consumption. This correlation analysis will help verify the interconnectedness of these variables, supporting or refuting prevailing economic theories regarding their interactions.

#Exploratory Analysis 
```{r}
options(repos = c(CRAN = "https://cloud.r-project.org"))

if (!require("readxl")) install.packages("readxl", dependencies = TRUE)
if (!require("corrplot")) install.packages("corrplot", dependencies = TRUE)

library(readxl)
library(corrplot)

#Siyao, we can't use the following data_path for everyone else.
data_path <- "/Users/chensiyao/Desktop/R/Final Project/Final Project_Env/Data/Raw/Data for R Project.xlsx"

if (file.exists(data_path)) {
  data <- read_excel(data_path)
  growth_data <- data[, c("GDPgro", "Popgro", "Invgro", "Electricitygro")]
  correlation_matrix <- cor(growth_data, use = "complete.obs")
  #only corrpplot part is needed here. We don't need to specify other parts.
  corrplot(correlation_matrix, method = "color", addCoef.col = "black",
           tl.col = "black", tl.srt = 45, cl.pos = "b", type = "upper",
           title = "Correlation Matrix of Growth Metrics")
  
  print(correlation_matrix)
} else {
  print("The file 'Data for R Project.xlsx' does not exist at the path specified.")
}
```
#Conlusion for Question1:
The heatmap displays the correlation coefficients between GDP growth, population growth, investment growth, and electricity consumption growth in Turkiye. Dark blue indicates strong positive correlations, dark red signifies strong negative correlations, and lighter shades denote weaker relationships. Notably, investment growth and electricity consumption exhibit a strong positive correlation with GDP growth, while population growth shows a negligible relationship. This visual suggests that investment and electricity consumption are closely tied to economic performance.



## Question2:
Is there a quantifiable impact of electricity consumption on GDP growth in Turkiye, when considering the effects of investment and population growth?

#Background:
Examination of Turkiye's economic growth by scrutinizing the interactions between GDP growth and key growth indicators: population, investment, and electricity consumption. This analysis aims to illuminate the intertwined influences of these variables from 1999 to 2022.

#Significance:
Grasping the dynamics between electricity consumption and GDP growth is essential. It underpins strategies for economic stability and advancement, reinforcing the findings by Kasperowicz (2014) on the importance of electricity in bolstering economic development.

#Theoratical Context:
The hypothesis central to this analysis posits that rising electricity consumption is a catalyst for GDP growth. This supposition is anchored in the rationale that investment, demographic changes, and energy consumption collectively articulate the narrative of GDP growth.

#Exploratory Analysis 
```{r}
#library(ggplot2)

# Perform linear regression of GDP growth on the other growth metrics
lm_model <- lm(GDPgro ~ Popgro + Invgro + Electricitygro, data=data)

residuals <- resid(lm_model)
fitted <- fitted(lm_model)
std_residuals <- rstandard(lm_model)
sqrt_std_residuals <- sqrt(abs(std_residuals))
leverage <- hatvalues(lm_model)

# Create a data frame for plotting
diagnostic_data <- data.frame(Fitted=fitted, Residuals=residuals, 
                              Standardized_Residuals=std_residuals, 
                              Sqrt_Standardized_Residuals=sqrt_std_residuals, 
                              Leverage=leverage)


# Residuals vs Fitted plot
ggplot(diagnostic_data, aes(x = Fitted, y = Residuals)) +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  geom_point() +
  geom_smooth(method = "loess", se = FALSE, color = "blue") +
  labs(title = "Residuals vs Fitted", x = "Fitted Values", y = "Residuals") +
  theme_minimal()

# Normal Q-Q plot
qq_data <- data.frame(Theoretical_Quantiles=qqnorm(residuals)$x, Standardized_Residuals=qqnorm(residuals)$y)
ggplot(qq_data, aes(x = Theoretical_Quantiles, y = Standardized_Residuals)) +
  geom_point() +
  geom_abline(intercept = mean(std_residuals), slope = sd(std_residuals), color = "blue", linetype = "dashed") +
  labs(title = "Normal Q-Q Plot", x = "Theoretical Quantiles", y = "Standardized Residuals") +
  theme_minimal()

# Scale-Location plot
ggplot(diagnostic_data, aes(x = Fitted, y = Sqrt_Standardized_Residuals)) +
  geom_point() +
  geom_smooth(method = "loess", se = FALSE, color = "blue") +
  labs(title = "Scale-Location Plot", x = "Fitted Values", y = "Square Root of Standardized Residuals") +
  theme_minimal()

# Residuals vs Leverage plot
ggplot(diagnostic_data, aes(x = Leverage, y = Standardized_Residuals)) +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  geom_point() +
  geom_smooth(method = "loess", se = FALSE, color = "blue") +
  labs(title = "Residuals vs Leverage", x = "Leverage", y = "Standardized Residuals") +
  theme_minimal()

```
#Conclusion for Question2:
These plots suggest that while the model fits to some degree, there are indications of non-linearity, potential heteroscedasticity, and influential points, all of which could affect the reliability of the regression model. 
1. Residuals vs Fitted Plot:
It reveals the residuals' spread against the predicted values (fitted values). The red dashed line at y=0 represents the expectation where residuals would lie if the model's predictions were perfect. The blue line shows a non-linear relationship suggesting the presence of non-linearity in the model.
2.Normal Q-Q Plot:
This plot is a graphical technique for determining if two data sets come from populations with a common distribution, in this case, if the residuals are normally distributed. Points deviating from the dashed line indicate departures from normality.
3.Scale-Location Plot:
It shows the spread of residuals, allowing us to check the assumption of equal variance (homoscedasticity). It seems that the residuals spread out in a non-constant manner against the fitted values, indicating potential heteroscedasticity.

#Question3:
In assessing the relationship between electricity consumption and GDP growth, how might outliers influence the regression model's results?

#Background:
Conduct an outlier analysis to identify data points that disproportionately influence the model's predictions.

#Significance:
By identifying and addressing outliers, we improve the model's accuracy and reliability, providing a sound basis for economic insights and decisions.

#Theoratical Context:
Our analysis is based on the assumption that while most data points conform to a general trend, some may deviate due to various factors. Cook's distance is a measure used to identify these influential outliers within the regression context.

#Exploratory Analysis 
```{r}
# Calculate Cook's distance for the model
cooks.distance <- cooks.distance(lm_model)

# Identify potential outliers (common threshold is 4/(n-k-1), where n is the number of observations and k is the number of predictors)
threshold <- 4 / (length(cooks.distance) - length(coef(lm_model)) - 1)
potential_outliers <- which(cooks.distance > threshold)

# Summary of potential outliers
print(potential_outliers)

# Plot to visualize potential outliers
plot(cooks.distance, pch="*", cex=2, main="Cook's Distance Plot")
abline(h = threshold, col = "red", lwd = 2, lty = 2)

```

#Conclusion for Question3:
 In this plot, while most points are within acceptable bounds, a few points significantly exceed the threshold, indicating they are outliers with substantial influence on the model. 
 
